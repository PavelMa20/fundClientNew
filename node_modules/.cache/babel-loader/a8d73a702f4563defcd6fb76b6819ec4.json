{"ast":null,"code":"'use strict';\n\nvar _jsxFileName = \"D:\\\\WebReact\\\\FundTest\\\\fundclient\\\\src\\\\components\\\\Uppload\\\\Uppload.js\";\nimport React from 'react';\nimport 'antd/dist/antd.css';\nimport './Uppload.css';\nimport { Upload, message, Button } from 'antd';\nimport { UploadOutlined } from '@ant-design/icons';\nimport XLSX from \"xlsx\";\nimport Modal from '../Modal/Modal'; // const props = {\n// accept: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n// name: 'file',\n// headers: {\n//   authorization: 'authorization-text',\n// },\n//   showUploadList: true,\n//   onChange(info) {\n//     if (info.file.status !== 'uploading') {\n//       console.log(info.file, info.fileList);\n//     }\n//     if (info.file.status === 'done') {\n//       message.success(`${info.file.name} file uploaded successfully`);\n//     } else if (info.file.status === 'error') {\n//       message.error(`${info.file.name} file upload failed.`);\n//     }\n//   },\n//   beforeUpload: (file, fileList) => {\n//     var rABS = true;\n//     const f = fileList[0];\n//     var reader = new FileReader();\n//     reader.onload = function (e) {\n//       var data = e.target.result;\n//       var workbook = XLSX.read(data, {\n//         type: rABS ? 'binary' : 'array'\n//       });\n//       var first_worksheet = workbook.Sheets[workbook.SheetNames[0]];\n//       var jsonArr = XLSX.utils.sheet_to_json(first_worksheet, { header: 1 });\n//       let resultArray = [];\n//       console.log(jsonArr);\n//       console.log(jsonArr.length);\n//       console.log(jsonArr[0].length);\n//       for (let i = 1; i < jsonArr.length; i++) {\n//         var objArray = [];\n//         for (let j = 0; j < jsonArr[0].length; j++) {\n//           var obj = new Object;\n//           obj = { key: jsonArr[0][j], value: jsonArr[i][j] };\n//           objArray.push(obj);\n//         }\n//         resultArray.push(objArray);\n//       }\n//       console.log(resultArray);\n//       http.post(\"/prejson\", resultArray);\n//     };\n//     if (rABS) reader.readAsBinaryString(f); else reader.readAsArrayBuffer(f);\n//     return false;\n//   }\n// };\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UPLOAD_PROPS = {\n  accept: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  name: 'file',\n  headers: {\n    authorization: 'authorization-text'\n  }\n};\n\nclass Uppload extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.showModal = () => {\n      this.setState({\n        show: true\n      });\n    };\n\n    this.hideModal = () => {\n      this.setState({\n        show: false\n      });\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.beforeUpload = this.beforeUpload.bind(this);\n    this.fileInput = /*#__PURE__*/React.createRef();\n    this.state = {\n      show: false\n    };\n    this.showModal = this.showModal.bind(this);\n    this.hideModal = this.hideModal.bind(this);\n  }\n\n  // handleChange(e) {\n  //   const files = e.target.files;\n  //   if (files && files[0]) this.props.handleFile(files[0]);\n  // }\n  handleChange(info) {\n    if (info.file.status !== 'uploading') {\n      console.log(info.file, info.fileList, \"arsi\");\n      this.showModal();\n    }\n\n    if (info.file.status === 'done') {\n      message.success(`${info.file.name} file uploaded successfully`);\n    } else if (info.file.status === 'error') {\n      message.error(`${info.file.name} file upload failed.`);\n    }\n  }\n\n  beforeUpload(file, fileList) {\n    var rABS = true;\n    const f = fileList[0];\n    var reader = new FileReader();\n\n    reader.onload = function (e) {\n      var _this$props$onUpload, _this$props;\n\n      this.showModal();\n      var data = e.target.result;\n      var workbook = XLSX.read(data, {\n        type: rABS ? 'binary' : 'array'\n      });\n      var first_worksheet = workbook.Sheets[workbook.SheetNames[0]];\n      var jsonArr = XLSX.utils.sheet_to_json(first_worksheet, {\n        header: 1\n      });\n\n      if (jsonArr.length > 0) {\n        this.showModal();\n      }\n\n      let resultArray = [];\n      console.log(jsonArr);\n      console.log(jsonArr.length);\n      console.log(jsonArr[0].length);\n\n      for (let i = 1; i < jsonArr.length; i++) {\n        var objArray = [];\n\n        for (let j = 0; j < jsonArr[0].length; j++) {\n          var obj = new Object();\n          obj = {\n            key: jsonArr[0][j],\n            value: jsonArr[i][j]\n          };\n          objArray.push(obj);\n        }\n\n        resultArray.push(objArray);\n      }\n\n      (_this$props$onUpload = (_this$props = this.props).onUpload) === null || _this$props$onUpload === void 0 ? void 0 : _this$props$onUpload.call(_this$props, resultArray); // http.post(\"/prejson\", resultArray);\n    }.bind(this);\n\n    if (rABS) reader.readAsBinaryString(f);else reader.readAsArrayBuffer(f);\n    return false;\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Upload, { ...UPLOAD_PROPS,\n      onChange: this.handleChange,\n      beforeUpload: this.beforeUpload,\n      showModal: this.showModal,\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        icon: /*#__PURE__*/_jsxDEV(UploadOutlined, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 23\n        }, this),\n        children: \"Click to Upload\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        show: this.state.show,\n        handleClose: this.hideModal,\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Modal\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst SheetJSFT = [\"xlsx\", \"xlsm\", \"xls\", \"csv\"];\nexport default Uppload;","map":{"version":3,"sources":["D:/WebReact/FundTest/fundclient/src/components/Uppload/Uppload.js"],"names":["React","Upload","message","Button","UploadOutlined","XLSX","Modal","UPLOAD_PROPS","accept","name","headers","authorization","Uppload","PureComponent","constructor","props","showModal","setState","show","hideModal","handleChange","bind","beforeUpload","fileInput","createRef","state","info","file","status","console","log","fileList","success","error","rABS","f","reader","FileReader","onload","e","data","target","result","workbook","read","type","first_worksheet","Sheets","SheetNames","jsonArr","utils","sheet_to_json","header","length","resultArray","i","objArray","j","obj","Object","key","value","push","onUpload","readAsBinaryString","readAsArrayBuffer","render","SheetJSFT"],"mappings":"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","sourcesContent":["'use strict';\r\nimport React from 'react';\r\nimport 'antd/dist/antd.css';\r\nimport './Uppload.css';\r\nimport { Upload, message, Button } from 'antd';\r\nimport { UploadOutlined } from '@ant-design/icons';\r\nimport XLSX from \"xlsx\";\r\nimport Modal from '../Modal/Modal';\r\n\r\n\r\n\r\n\r\n// const props = {\r\n  // accept: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n  // name: 'file',\r\n  // headers: {\r\n  //   authorization: 'authorization-text',\r\n  // },\r\n\r\n//   showUploadList: true,\r\n//   onChange(info) {\r\n//     if (info.file.status !== 'uploading') {\r\n//       console.log(info.file, info.fileList);\r\n//     }\r\n//     if (info.file.status === 'done') {\r\n//       message.success(`${info.file.name} file uploaded successfully`);\r\n//     } else if (info.file.status === 'error') {\r\n//       message.error(`${info.file.name} file upload failed.`);\r\n//     }\r\n//   },\r\n//   beforeUpload: (file, fileList) => {\r\n\r\n//     var rABS = true;\r\n//     const f = fileList[0];\r\n//     var reader = new FileReader();\r\n//     reader.onload = function (e) {\r\n//       var data = e.target.result;\r\n\r\n//       var workbook = XLSX.read(data, {\r\n//         type: rABS ? 'binary' : 'array'\r\n//       });\r\n//       var first_worksheet = workbook.Sheets[workbook.SheetNames[0]];\r\n//       var jsonArr = XLSX.utils.sheet_to_json(first_worksheet, { header: 1 });\r\n\r\n//       let resultArray = [];\r\n//       console.log(jsonArr);\r\n//       console.log(jsonArr.length);\r\n//       console.log(jsonArr[0].length);\r\n//       for (let i = 1; i < jsonArr.length; i++) {\r\n//         var objArray = [];\r\n//         for (let j = 0; j < jsonArr[0].length; j++) {\r\n//           var obj = new Object;\r\n//           obj = { key: jsonArr[0][j], value: jsonArr[i][j] };\r\n//           objArray.push(obj);\r\n//         }\r\n//         resultArray.push(objArray);\r\n\r\n//       }\r\n//       console.log(resultArray);\r\n\r\n//       http.post(\"/prejson\", resultArray);\r\n\r\n//     };\r\n//     if (rABS) reader.readAsBinaryString(f); else reader.readAsArrayBuffer(f);\r\n//     return false;\r\n//   }\r\n\r\n// };\r\n\r\nconst UPLOAD_PROPS = {\r\n  accept: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n  name: 'file',\r\n  headers: {\r\n    authorization: 'authorization-text',\r\n  },\r\n}\r\n\r\n\r\nclass Uppload extends React.PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.beforeUpload = this.beforeUpload.bind(this);\r\n    this.fileInput = React.createRef();     \r\n    this.state = {\r\n      show: false\r\n    };\r\n    this.showModal = this.showModal.bind(this);\r\n    this.hideModal = this.hideModal.bind(this);   \r\n  }\r\n  showModal = () => {\r\n    this.setState({ show: true });\r\n  };\r\n\r\n  hideModal = () => {\r\n    this.setState({ show: false });\r\n  };\r\n  \r\n  // handleChange(e) {\r\n  //   const files = e.target.files;\r\n  //   if (files && files[0]) this.props.handleFile(files[0]);\r\n  // }\r\n\r\n  handleChange(info) {\r\n    if (info.file.status !== 'uploading') {\r\n      console.log(info.file, info.fileList,\"arsi\");\r\n     this.showModal();\r\n    }\r\n    if (info.file.status === 'done') {\r\n      message.success(`${info.file.name} file uploaded successfully`);\r\n    } else if (info.file.status === 'error') {\r\n      message.error(`${info.file.name} file upload failed.`);\r\n    }\r\n  }\r\n\r\n  beforeUpload(file, fileList) {\r\n    var rABS = true;\r\n    const f = fileList[0];\r\n    var reader = new FileReader();\r\n    reader.onload = function (e) {\r\n      this.showModal();\r\n      var data = e.target.result;\r\n\r\n      var workbook = XLSX.read(data, {\r\n        type: rABS ? 'binary' : 'array'\r\n      });\r\n      var first_worksheet = workbook.Sheets[workbook.SheetNames[0]];\r\n      var jsonArr = XLSX.utils.sheet_to_json(first_worksheet, { header: 1 });\r\n      if(jsonArr.length>0){\r\n        this.showModal();\r\n      }\r\n\r\n      let resultArray = [];\r\n      console.log(jsonArr);\r\n      console.log(jsonArr.length);\r\n      console.log(jsonArr[0].length);\r\n      for (let i = 1; i < jsonArr.length; i++) {\r\n        var objArray = [];\r\n        for (let j = 0; j < jsonArr[0].length; j++) {\r\n          var obj = new Object;\r\n          obj = { key: jsonArr[0][j], value: jsonArr[i][j] };\r\n          objArray.push(obj);\r\n        }\r\n        resultArray.push(objArray);\r\n\r\n      }\r\n\r\n      this.props.onUpload?.(resultArray);\r\n\r\n      // http.post(\"/prejson\", resultArray);\r\n\r\n    }.bind(this);\r\n    if (rABS) reader.readAsBinaryString(f); else reader.readAsArrayBuffer(f);\r\n    return false;\r\n  }\r\n\r\n \r\n\r\n  render() {\r\n\r\n    return (\r\n\r\n      <Upload\r\n        {...UPLOAD_PROPS}\r\n        onChange={this.handleChange}\r\n        beforeUpload={this.beforeUpload}\r\n        showModal={this.showModal}\r\n      \r\n        \r\n      >\r\n        <Button icon={<UploadOutlined />}>Click to Upload</Button>\r\n        <Modal show={this.state.show} handleClose={this.hideModal}>\r\n          <p>Modal</p>\r\n        </Modal>\r\n        {/* <input\r\n          type=\"file\"\r\n          hidden\r\n          accept={SheetJSFT}\r\n          ref={this.fileInput}\r\n          onChange={this.handleChange}\r\n\r\n        /> */}\r\n      </Upload>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nconst SheetJSFT = [\r\n  \"xlsx\",\r\n  \"xlsm\",\r\n  \"xls\",\r\n  \"csv\",\r\n\r\n]\r\nexport default Uppload;"]},"metadata":{},"sourceType":"module"}